name: C/C++ CI ubuntu

on:
  workflow_dispatch:
      branches: [ master ]
      

jobs:
  build:

    runs-on: ubuntu-22.04

    steps:
    
#    - uses: actions/setup-python@v4
#      with:
#        python-version: '3.9'
#        archtecture: 'x86'

    - name: setup GCC
      uses: egor-tensin/setup-gcc@v1
      with:
        version: latest
        platform: x64
       
    - name: Install Qt
      uses: jurplel/install-qt-action@v3
      with:
        host: 'linux'
        target: 'desktop'
        version: '5.9.1'
        modules: 'qtcharts qtscript qtwebengine qtdatavis3d qtpurchasing qtvirtualkeyboard qtnetworkauth qtwebglplugin debug_info'
        #setup-python: 'fales'
        ##arch: 'gcc_64'
        #modules: 'Desktop gcc 64-bit Debug Information Files Qt Charts for gcc 64-bit Qt Data Visualization for gcc 64-bit Qt Lottie Animation for gcc 64-bit Qt Network Authorization for gcc 64-bit Qt Purchasing for gcc 64-bit Qt Quick 3D for gcc 64-bit Qt Quick Timeline for gcc 64-bit Qt Script for gcc 64-bit Qt Virtual Keyboard for gcc 64-bit Qt Wayland Compositor for gcc 64-bit Qt WebEngine for Desktop gcc 64-bit Qt WebGL Streaming Plugin for gcc 64-bit'

        
    - uses: actions/checkout@v3
    - name: qmake
      run: qmake -makefile CaptureStream.pro
    - name: make
      run: make
      
    - name: Make CaptureStream executable
      run: chmod -R 755 ./CaptureStream
  
    - uses: actions/upload-artifact@v3
      with:
        name: CaptureStream
        path: ./CaptureStream
